# RSA1
## Đề bài

## Cách giải

# RSA2
## Đề bài
[small_primes.txt](https://github.com/LuluL0g1n/RSA-CTFd/files/8230912/small_primes.txt)

## Cách giải
>Đưa n lên alpetron
>Dễ dàng tìm được phi = 9535271629301589525422576327693640998475630016999686925425224437013127985147802319031537598149797844942164796406426778044571228816186195955328110080000
```python
from Crypto.Util.number import long_to_bytes
n = 9535271629301589543980737788527614014746809465076973703910968482522722398246280610827753553656401385478044310802319122874965273190562705759366029705507
e = 65537
c = 4552577387909336101290973882061311505705840831095295560114130894123462456438533356021283525714896620886904381766963261172543338282153176336375423711746
phi= 9535271629301589525422576327693640998475630016999686925425224437013127985147802319031537598149797844942164796406426778044571228816186195955328110080000
d = pow(e,-1,phi)
p = pow(c,d,n)
print(long_to_bytes(p))
```
>Flag: KCSC{sm4ll_pr1m3s_RSA}
# RSA3
## Đề bài
```py
from Crypto.Util.number import getPrime, long_to_bytes, bytes_to_long

p = getPrime(1024)
q = getPrime(1024)
n = p*q
e1 = 65537
e2 = 75149

flag = b"KCSC{??????????????????????????????}"
flag = bytes_to_long(flag)


print("n =", n)
print("e1 =", e1)
print("e2 =", e2)
print("c1 =", pow(flag, e1, n))
print("c2 =", pow(flag, e2, n))
```
## Cách giải
> Đây là cuộc tấn công khi hệ thống sử dựng chung Modulus n
> Đầu tiên, ta tính u và v sao cho e1*u +e2*v = 1
> Tiếp đó ta tính m = (c1**u * c2**v) mod n. Nhưng có 1 lưu ý là máy tính sẽ không thể tính số mũ âm. Để khắc phục, ta sẽ tìm nghịch đảo của c1 (hoặc c2) rồi nhân với -u (hoặc -v)
```py
from Crypto.Util.number import getPrime, long_to_bytes, bytes_to_long
from gmpy2 import *

n = 15579041570549183877401062883225064299178659043622586326963894017668885771169636712942686974999467879138974673149238487346310183336299089723487535740955948164498209901918300643614745826133137188932678606032108627681713691545274099467785963695418741480158320568510332737549597969492465647544816476555527239578233498209294274834241435820100991805128484208187048402940657482492065868157791190013243763420906365240091105428192424185460937658483639186279855483707861986225957226824310616917954908062532412789164114438795637888280201795046396416617689806171608152291471471949544980200060392170827892405521363533899736434247
e1 = 65537
e2 = 75149
c1 = 958526646277295724168009763547786278668380497329915140390103080680844142220311835231176539706940958185703282540090844790805926548562491707936898169971263214280928361192803914900711720516558785577328679478102652166699188348694283992899346710699398385080627647392716832230871696605207075465964043078170464673712948247266791210646386374224164686149805328815931460563641454551397839079551430437448424836655869893565997221053407805155266300105570480915918775573741222285317386894157207021041886667232226686999026179007570092208455517449469430164063484188279221791507821580835493377236195443037703666043783154843296991980
c2 = 3364518837513546914916005862604690518243236022813143522634472702326113779354144548308524567399600026328302880849426586750023085953031035137263786380775479526123612089514173828715534956705435799574041315156819482550812270343681022195190739255746660599014578195344360880947115223661898250852906842786202954907911849356980822061691461413625527967303128318228029968148086918927848492525738193529285664626595877347027761575638243519289812130710352217003140546189017707851552139715658490173123320649047145805707417652762434393193118047679875378528913314061444052618140209949527982609241727893221732721184392506829957203306


a, u, v = gmpy2.gcdext(e1, e2)
if u < 0: # if u < 0, compute c1_inv
	c1_inv = gmpy2.invert(c1, n)
	M = (c1_inv**(-u) * c2**v) % n
else:
	c2_inv = gmpy2.invert(c2, n)
	M = (c2_inv**(-v) * c1**u) % n
print(long_to_bytes(M))
```
>Flag: KCSC{_c0mm0n_m0dulus_______________}
# RSA4
## Đề bài
>nc 45.77.45.157 2001
> Khi kết nối vào server, đề bài có dạng
```py
N = 21378667931199276338370011741227524129945669885033568171656783282181027535940061730465405021541721416736153545509533632414205255992334740106828252025287133651326712421795445297892010009917135994313336107831525963185342666378912520924052846309390579657966861426005324930213699645799711742116354768819737262622594661397019520964158280894145911063521478825703972240143270010144457461483193971543428295119258020737797992098538874901549371449603393514898283289704370769468330844164623438319821355632055953685577654402962561032944961109656733162955186738763913181658190897744326562399396378280993318527910715532873442129251
e = 65537
Encrypted flag = 167894554785480306826878205987550692770427731265060203217877640766075034712344266664563329840070738038426987613238788997805942350316300071248205240977133020346393132763362277541240212075383781149475087978596206563460822865677120991062450230535321311670960353242251658625382471432755963354761726279090387369912866120559012164335003236562744010906637917145199385302921486430002791885029513304306488400001282114540724575823147229526813199242223926143228528736483127382528928627689585219389219323347817125815003350567133314576864267622633142251016434546737318674774462590062630987018570025219653762235745916609690360659
Input your ciphertext:
```
## Cách giải
> Đầu tiên, thử copy encrypted flag điền vào chỗ input your ciphertext, nhưng server yêu cầu nhập số khác
> Thử 1 sô bất kì server trả về plaintext của số đó thông qua thuật toán RSA sử dụng d và N
> Đến đây ta có 1 lỗ hổng: giả sử ta gửi cho server 1 đoạn ciphertext có giá trị = Encrypted flag * (2**e)
> Vì thông qua server, họ sẽ trả về 1 đoạn plaintext
> Nhưng plaintext ở đây có chút thú vị: Encrypted flag = (flag**e)mod n => Encrypted flag * (2**e) = (flag * 2) ** e mod n
> Plaintext = (flag * 2) ** ed mod n = flag * 2
> Giờ đã quá dễ để tìm flag
```py
from Crypto.Util.number import long_to_bytes
N = 21378667931199276338370011741227524129945669885033568171656783282181027535940061730465405021541721416736153545509533632414205255992334740106828252025287133651326712421795445297892010009917135994313336107831525963185342666378912520924052846309390579657966861426005324930213699645799711742116354768819737262622594661397019520964158280894145911063521478825703972240143270010144457461483193971543428295119258020737797992098538874901549371449603393514898283289704370769468330844164623438319821355632055953685577654402962561032944961109656733162955186738763913181658190897744326562399396378280993318527910715532873442129251
e = 65537
c = 167894554785480306826878205987550692770427731265060203217877640766075034712344266664563329840070738038426987613238788997805942350316300071248205240977133020346393132763362277541240212075383781149475087978596206563460822865677120991062450230535321311670960353242251658625382471432755963354761726279090387369912866120559012164335003236562744010906637917145199385302921486430002791885029513304306488400001282114540724575823147229526813199242223926143228528736483127382528928627689585219389219323347817125815003350567133314576864267622633142251016434546737318674774462590062630987018570025219653762235745916609690360659
x =print(c*pow(2,65537)%N)
# Đưa giá trị x lên server, server trả giá trị d = 1038892122233357139058894143364470935388104815466022283445225336070395642
d = 1038892122233357139058894143364470935388104815466022283445225336070395642
print(long_to_bytes(d//2))
```
>Flag: KCSC{ch0sen_c1phertext_4tt4ck}
# RSA5
## Đề bài
[Wiener-attack.txt](https://github.com/LuluL0g1n/RSA-CTFd/files/8231061/Wiener-attack.txt)

## Cách giải
>Như tên gọi, cách giải bài này là sử dụng Wiener's attack
```py
import owiener
n = 4132976885313620989793138232237857485698296237464660843315969036074678733191191577685180205697480631542751907366655945998120743803779982256919952243360171622255710620255448449934374799426944976112754122373672543300475307874859246944968687601079412328357824701323041241341274623879229479225565485630084007195867934589763500476352488857570266688948676558779645051259275472615017031239454654649250067852440038216514254375247334297284709102711047491074903964306850091668210467313746721
e = 1750050028811042317092326965718758083501771847947887293515411772102890164760552659457975064653911340940187822648462652483456640570963224225417353368313169226726553908832781209174212992300450276992090024394416526941239015616616221568602574848593841017150941057063859910043814071580107820286653129237982205855538973817418438652522623026562425971136775219067133693665110372249308179365513518843406292774596623071641859580717087301634730699160968730685078033151203026378458630658027183
d=owiener.attack(e,n)
if d is None:
    print('falied')
else:
    print(d)
from Crypto.Util.number import long_to_bytes
d = 716190187
c = 281833041089031329877955708537883567595102587735700060795910832047971578904265919004493566623179634029899784120656782497079401966828978655173874757033079671295302908540302580553411001062296038906480815096344660583927786701256080412482545291031999575562354075125133028508948916979768605898769848805716444664173353566191136536691509637139284690177133420104271519555154357534379993283611943343212541981157950089731344739020706609848032078220759256353608507103460929949946267236256484
print(long_to_bytes(pow(c,d,n)))
```
>Flag: KCSC{Wiener's_attack__and__the_continued_fraction_method}
# RSA6
## Đề bài
[rsa_broadcast1.txt](https://github.com/LuluL0g1n/RSA-CTFd/files/8231062/rsa_broadcast1.txt)

## Cách giải
> Đề bài cho rất nhiều e và n => tỉ lệ rất lớn là broadcast attack
```py
from Crypto.Util.number import long_to_bytes
from sympy.ntheory.modular import crt
import gmpy2

e = 3
n1 = 15211798436362885588723897472623293108591910720248957088525019147693538931418263644191188384087192671444613094034228918351752803921214902780115562729109781194564524730616678647299169668840956022253982803940312167051028025651451365086567411697105580823877496322214373858833329503752687389688721464285614416771633832582443831661924525300740587474479915929822185275968765754620639022007556456154273657783836757234869195977992123246001228697364075063631187467467697745958645305050039195409454420883812093851985406438672509679246467362469273159499487930727024310388797737943309901526797320729580549192841964736229600813437
n2 = 21626591969748724512355177924918151334158692957275724877201419607370019278469828125430933124647057504933171869087241002295484088598636458608105322242001060441558558278797676461391977116810622817635779677982150953706982381323844252445458244135760020640138808906951682479395863864919549962007373607664366817674762287851196714326243612440231068277212588495380690697891854959356395382045100868123379468012270186296103993203562175010292310086073927253450438086216611208684799637796464261482073508874703244824884346950888805872923441649245961999831565337681569234397762306502810178342042653449265916866561749583475708506489
n3 = 19097512400706369325816400961039266520829132024949428791526363177058945505751899029358156804216166758940650597868797785258374150813571509380064038840061726644717439998319734158962470548255317210745880084736970984390975595882829502051653319165598723830478149695519141929068772902346767236824342095368037621017207832466086004587771992170123884424073079485433784440021512429824282637400305642774699534138130348712885010916063585549753598230434385619415390706485902887757182780700303004691590541073975281734461423828352816003269155485065897617967030890926979120590779492197580892502646039371764232471906522526296219044183
c1 = 3251198529556591276640909876291141541737775776637150826274246892380018296361827635107478892116516384634504571893928896554767181567637566254415357054493250586599382503595829321201216536132199851851618953852014243314378960676373786613246133182982555838167962717812421434737360297550708423100886906991055921147284735674702176413796610353804517146466379878388359517757702427076082967853155861099707602779621105223657419322088524733685896548987843869707507601904751483232766421541178894496409959520397121463742851694646049947955175502597943566531090437882873905976886981851527484314251722489360942946805553642641785533871
c2 = 15135217823526097772519900957933040202807636182314280311189695893431054786303987708413474068415707150513323386429214635854762776745555347371832883008219672632749941935077295393195697128178492924391678205067775743757767823864584237860003012359695072221700711595856530791714211924064550268243631243362766987128956040475445498266176256225045064611375849108128270761940506410647731412975500973418593459625869469510858206856760736855983352421016179474694787887698754428107461346078193499703174230170749626788692302178224413858188847383010551271438663317946456212396542276796630964988477451722975130905027330444176318042328
c3 = 15355054927350813303626858433403916623058859059252777554479910220092612925381550409545199089214160097848435742400812973625531286808230922571593810018171046879915634188717607339504062256793383771946376984232533453731145028391895516576634761731653648183572968742139920212951333594010550127064134533054100929996820183698904676540298678839115953892905947613857277985039554670042470713722826404341171096982285681133879305459751292317392125967997245763135235288243153509814572254592078683963265503724069453798934980668326437279129145084847542959442317212953913062182429893663058924717141868300505345393715099015666896636500

list_c = [c1,c2,c3]
list_n = [n1,n2,n3]

kq = crt(list_n,list_c)
M=int(kq[0])
print(long_to_bytes(gmpy2.iroot(M,3)[0]))
```
>Flag: KCSC{H4st4d's_bro4dc4st_4tt4ck}
# RSA7
## Đề bài
[rsa_broadcast2.txt](https://github.com/LuluL0g1n/RSA-CTFd/files/8231063/rsa_broadcast2.txt)

## Cách giải
